import React, { useState, useEffect } from 'react';
import styled from 'styled-components';
import { useDispatch, useSelector } from 'react-redux';
import { history } from '../redux/configStore';
// modules
import { deleteCartRx } from '../redux/modules/cart';
// elements & components
import { Grid, Text } from '../elements';
// icons
import { IoIosArrowUp, IoIosArrowDown } from 'react-icons/io';
import { TiDeleteOutline } from 'react-icons/ti';


/** 
 * @param {*} props
 * @returns 장바구니 내역 및 버튼
 * @역할 장바구니를 보여주는 언더바
 * @필수값 리덕스에서 오는 장바구니 목록
 * @담당자 : 박용태
*/

const UnderBar = (props) => {
// dispatch
  const dispatch = useDispatch();
// props
  const cart_list = useSelector((state) => state.cart.cart);
  const [barOnOff, barSet] = useState(false);
// useEffect

  // 열고 닫는 
  const toggleCart = () => {
    if (barOnOff === false) {
      barSet(true);
    }else{
      barSet(false);
    }
  };

  // 카트 내용 삭제
  const deleteCart = (foodId) => {
    dispatch(deleteCartRx(foodId));
  };

  console.log(cart_list);

  if ( cart_list.length === 0 ) {
    return <></>;
  }
  return (
    <React.Fragment>
      <CartContainer 
      style={{ transform: `translate(0, ${barOnOff ? '0%' : 'calc(100% - 10vh)'})` }}
        >

          {/* 언더바 버튼 */}
          <Grid _onClick={toggleCart} display="flex" jc="center" align-items="center" height="2.3vh" width="20px" margin="1.2vh auto" m_margin="1.2vh auto" cursor>
            {barOnOff ? 
            <IoIosArrowDown size="20px" color="#757575"/>
            : <IoIosArrowUp size="20px" color="#757575"/> }
          </Grid>
          
          {/* 즐겨찾기 항목 */}
          <Grid padding="0 5% 3% 5%" display="flex" fw="wrap">
            {cart_list.map((cart, idx) => {
              return (
                <CartButton key={idx}>
                  <Text line-height="18px" m_line-height="18px" size="13px" m_size="13px" color="#2A2A2A" padding="0" margin="0">
                    {cart.name}
                  </Text>
                  <div onClick={()=>{deleteCart(cart.foodId)}}>
                    <TiDeleteOutline size="17px" color="#404040"/>
                  </div>
                </CartButton>
              )
            })}
          </Grid>
          
          {/* 계산하러가기 버튼 */}
          <CalcBox>
            <div onClick={()=>{history.push('/cart')}}>
              <Text size="17px" m_size="15px" bold padding="0" margin="0">계산하러가기</Text>
            </div>
          </CalcBox>

        </CartContainer>
    </React.Fragment>
  );
}

UnderBar.defaultProps = {

}

const CartContainer = styled.div`
  max-width: 420px;
  width: 100%;
  min-height: 12.5%;
  position: fixed;
  bottom: 9%;
  border: none;
  border-top-left-radius: 24px;
  border-top-right-radius: 24px;
  box-shadow: 0px -5px 22px -8px rgba(0, 0, 0, 0.14);
  background: #fff;
  z-index: 300;
  transition: 1s ease;

  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
`;

const CalcBox = styled.div`
  width: 100%;
  padding: 3.8vh 20px 2.8vh 20px;

  & > div {
    width: 100%;
    height: 6.25vh;
    background: #FFE899;
    border: none;
    border-radius: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
  }
`;

const CartButton = styled.div`
  height: 4vh;
  padding: 5px 2.8% 5px 1.9%;
  background: #E4E4E4;
  border-radius: 24px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: 5px 1%;

  & > div {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }
`;

export default UnderBar;

<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect width="33.7476" height="34" rx="10" fill="#FFE899"/>
<path d="M22.1488 9.75961C21.8861 9.51289 21.5344 9.38577 21.176 9.40802C20.0869 9.50888 19.059 9.9604 18.2445 10.6957C17.5073 11.4385 16.3906 13.6974 17.3197 14.6511C17.5824 14.8979 17.9341 15.025 18.2925 15.0027C19.3817 14.9022 20.4096 14.4506 21.224 13.715C21.9612 12.9723 23.0779 10.7133 22.1488 9.75961ZM21.4552 11.5835V11.6055C21.2704 12.1544 20.9815 12.6618 20.6045 13.0997C19.951 13.6584 19.1451 14.0046 18.2925 14.093C18.1656 14.1057 18.0384 14.0713 17.9348 13.9963C17.8083 13.8688 17.7821 13.4469 18.009 12.7965C18.1938 12.2476 18.4826 11.7401 18.8596 11.3022C19.5101 10.7303 20.3181 10.3715 21.176 10.2738C21.3029 10.2611 21.4301 10.2955 21.5337 10.3705C21.6602 10.5111 21.682 10.933 21.4552 11.5835Z" fill="#F19F13"/>
<path d="M22.1488 15.0995C21.8861 14.8528 21.5344 14.7256 21.176 14.7479C20.0869 14.8487 19.059 15.3002 18.2445 16.0356C17.5073 16.7783 16.3906 19.0373 17.3197 19.991C17.5824 20.2376 17.9341 20.3648 18.2925 20.3426C19.3817 20.242 20.4096 19.7905 21.224 19.0549C21.9612 18.3121 23.0779 16.0531 22.1488 15.0995ZM21.4552 16.9233V16.9453C21.2704 17.4942 20.9815 18.0017 20.6045 18.4396C19.9542 19.0117 19.1461 19.3705 18.2881 19.468C18.1612 19.4807 18.034 19.4463 17.9304 19.3713C17.8039 19.2438 17.7778 18.8219 18.0046 18.1715C18.1894 17.6226 18.4783 17.1151 18.8552 16.6772C19.5057 16.1053 20.3137 15.7465 21.1716 15.6488C21.2986 15.6361 21.4258 15.6705 21.5293 15.7455C21.6602 15.851 21.682 16.2905 21.4552 16.9233Z" fill="#F19F13"/>
<path d="M22.1488 20.4393C21.8861 20.1926 21.5344 20.0655 21.176 20.0877C20.0869 20.1886 19.059 20.6401 18.2445 21.3754C17.5073 22.1181 16.3906 24.3771 17.3197 25.3308C17.5824 25.5775 17.9341 25.7047 18.2925 25.6824C19.3817 25.5819 20.4096 25.1303 21.224 24.3947C21.9612 23.652 23.0779 21.393 22.1488 20.4393ZM21.4552 22.2632V22.2852C21.2697 22.8275 20.9823 23.3288 20.6089 23.7618C19.9586 24.334 19.1505 24.6928 18.2925 24.7902C18.1656 24.803 18.0384 24.7686 17.9348 24.6936C17.8083 24.5661 17.7821 24.1442 18.009 23.4938C18.1942 22.9464 18.4831 22.4405 18.8596 22.0039C19.5101 21.4319 20.3181 21.0732 21.176 20.9755C21.3029 20.9627 21.4301 20.9971 21.5337 21.0722C21.6602 21.1908 21.682 21.6083 21.4552 22.2632Z" fill="#F19F13"/>
<path d="M15.1742 10.665C14.3597 9.92964 13.3319 9.47812 12.2428 9.37725C11.8844 9.355 11.5326 9.48213 11.27 9.72885C10.3452 10.665 11.4576 12.9195 12.1948 13.6843C13.0091 14.4199 14.0371 14.8714 15.1262 14.972C15.4847 14.9942 15.8364 14.8671 16.099 14.6204C17.0282 13.6843 15.9114 11.4297 15.1742 10.665ZM15.4752 14.0095C15.3717 14.0845 15.2445 14.1189 15.1175 14.1062C14.2596 14.0087 13.4515 13.6499 12.8011 13.0778C12.4242 12.6399 12.1353 12.1324 11.9505 11.5835C11.7368 10.933 11.7586 10.5111 11.8851 10.3837C11.9886 10.3086 12.1158 10.2743 12.2428 10.287C13.1007 10.3847 13.9087 10.7435 14.5591 11.3154C14.933 11.754 15.2189 12.2615 15.4011 12.8097C15.6279 13.4645 15.6017 13.882 15.4752 14.0095Z" fill="#F19F13"/>
<path d="M15.1742 16.018C14.3597 15.2827 13.3319 14.8311 12.2428 14.7303C11.8844 14.708 11.5326 14.8352 11.27 15.0819C10.3452 16.018 11.4576 18.2726 12.1948 19.0373C13.0091 19.7729 14.0371 20.2245 15.1262 20.325C15.4847 20.3472 15.8364 20.2201 16.099 19.9734C17.0282 19.0373 15.9114 16.7827 15.1742 16.018ZM15.4752 19.3493C15.3717 19.4244 15.2445 19.4588 15.1175 19.446C14.2596 19.3486 13.4515 18.9898 12.8011 18.4176C12.4242 17.9797 12.1353 17.4723 11.9505 16.9233C11.7368 16.2905 11.7586 15.851 11.8851 15.7235C11.9886 15.6485 12.1158 15.6141 12.2428 15.6268C13.1007 15.7246 13.9087 16.0833 14.5591 16.6552C14.933 17.0939 15.2189 17.6013 15.4011 18.1495C15.6279 18.8044 15.6017 19.2219 15.4752 19.3493Z" fill="#F19F13"/>
<path d="M15.1742 21.3754C14.3597 20.6401 13.3319 20.1886 12.2428 20.0877C11.8844 20.0655 11.5326 20.1926 11.27 20.4393C10.3452 21.3754 11.4576 23.63 12.1948 24.3947C13.0091 25.1303 14.0371 25.5819 15.1262 25.6824C15.4847 25.7047 15.8364 25.5775 16.099 25.3308C17.0282 24.3771 15.9158 22.1181 15.1742 21.3754ZM15.4839 24.6892C15.3804 24.7642 15.2532 24.7986 15.1262 24.7859C14.2688 24.6897 13.4607 24.3324 12.8099 23.7618C12.4329 23.3239 12.144 22.8165 11.9592 22.2676C11.7324 21.6127 11.7586 21.1952 11.8807 21.0678C11.9843 20.9927 12.1115 20.9583 12.2384 20.9711C13.0983 21.0692 13.908 21.4295 14.5591 22.0039C14.932 22.4399 15.2178 22.9442 15.4011 23.4894C15.6366 24.1398 15.6105 24.5617 15.4839 24.6892Z" fill="#F19F13"/>
<path d="M16.6481 25.6561C16.4072 25.6561 16.2119 25.8529 16.2119 26.0956V29.7785C16.2119 30.0213 16.4072 30.218 16.6481 30.218C16.889 30.218 17.0844 30.0213 17.0844 29.7785V26.0956C17.0844 25.8529 16.889 25.6561 16.6481 25.6561Z" fill="#F19F13"/>
<path d="M14.3015 5C14.0606 5 13.8652 5.19678 13.8652 5.43949V9.12242C13.8652 9.36513 14.0606 9.56191 14.3015 9.56191C14.5424 9.56191 14.7377 9.36513 14.7377 9.12242V5.43949C14.7377 5.19678 14.5424 5 14.3015 5Z" fill="#F19F13"/>
<path d="M16.6481 6.31848C16.4072 6.31848 16.2119 6.51526 16.2119 6.75797V10.4409C16.2119 10.6836 16.4072 10.8804 16.6481 10.8804C16.889 10.8804 17.0844 10.6836 17.0844 10.4409V6.75797C17.0844 6.51526 16.889 6.31848 16.6481 6.31848Z" fill="#F19F13"/>
<path d="M18.9909 5C18.75 5 18.5547 5.19678 18.5547 5.43949V9.12242C18.5547 9.36513 18.75 9.56191 18.9909 9.56191C19.2318 9.56191 19.4271 9.36513 19.4271 9.12242V5.43949C19.4271 5.19678 19.2318 5 18.9909 5Z" fill="#F19F13"/>
</svg>
